\subsection{Höhere Induktive Typen}

Höhere induktive Typen haben neben Konstruktoren der Bauart, die wir bereits von den Induktiven Typen kennen, sogenannte \begriff{höhere Konstruktoren},
deren Werte in Gleichheitstypen des höheren induktiven Typs liegen.
Später werden wir auch höhere induktive Typen mit höheren Konstruktoren, die in iterierten Gleichheitstypen liegen, sehen.
Zunächst wird der Typ $S¹$ zentral sein. Dieser hat wie der Typ $\eins$ einen Punkt-Konstruktor $\ast:S^1$ und zusätzlich einen
höheren Konstruktor $l:\ast =_{S^1}\ast$.

Eine Rekursionsregel ist leicht formuliert: Um eine Funktion $f:S^1\to A$ zu definieren, muss man $f(\ast):A$ und $f(l):f(\ast)=_A f(\ast)$ vorgeben.
Das Induktionsprinzip ist etwas unhandlicher und wir wollen zunächst ein paar Definition machen, die uns die Formulierung erleichtern und schließlich nach der Einführung der neuen Regeln
das Rekursionsprinzip aus dem Induktionsprinzip folgern.

In \cref{lem:gleichheit-summe} haben wir festgestellt, dass ein Teil einer Gleichheit in einer abhängigen Summe von der Form
\begin{mathpar}
  \transp_B(p)(b)=b'
\end{mathpar}
ist. Das werden wir jetzt als allgemeine Definition von Gleichheiten in abhängigen Typen verwenden.
\begin{definition}[Abhängige Gleichheit]
  Seien $A:\mU$, und $B:A\to \mU$. Seien weiter $x,y:A$, $b:B(x)$ und $b':B(y)$.
  \begin{enumerate}
  \item Sei $p:x=_A y$. Ein \begriff{abhängier Pfad} oder eine \begriff{abhängige Gleichheit} zwischen $b$ und $b'$ ist ein Element des Typs
    \begin{mathpar}
      \left(b =_p^B b'\right)\colonequiv \left(\transp_B(p)(b)=b'\right)
    \end{mathpar}
  \item Sei $s:\prod_{x:A}B(x)$ eine abhängige Funktion. Die folgende Funktion ist die Anwendung eine abhängigen Funktion auf eine Gleichheit:
    \begin{mathpar}
      \mathrm{apd}(s):\prod_{p:x=_A y}s(x)=_p^B s(y)
    \end{mathpar}
    und festgelegt durch $\mathrm{apd}(s,\refl_x)\colonequiv\refl_b$. Wir schreiben auch $s(p)$ für $\mathrm{apd}(s,p)$.
  \end{enumerate}
\end{definition}

Damit können wir die folgenden Regeln für den induktiven Einheitskreis leichter formulieren.
Zunächst wollen wir noch die abhängige Variante mit der bekannten Anwendung von Funktionen auf Gleichheiten vergleichen:

\begin{bemerkung}
  \label{bem:transpconst}
  Seien $A,B:\mU$. Dann gilt:
  \begin{enumerate}
  \item Für $x,y:A$, $p:x=_A y$ und alle $b:B$ erhalten wir eine abhängige Gleichheit
    \begin{mathpar}
      \transpconst_{p,b}:\transp_{\_\mapsto B}(p)(b)=b
    \end{mathpar}
    durch Induktion über $p$ und $\transpconst_{\refl_x,b}\colonequiv \refl_b$.
  \item Für $f:A \to B$ und $p:x =_A y$ gilt $\mathrm{apd}(f,p)= \transpconst_{p,f(x)}\kon\mathrm{ap}(f,p)$.
  \end{enumerate}
\end{bemerkung}
\begin{beweis}
  \begin{enumerate}
  \item Bereits erledigt.
  \item Induktion über $p$.
  \end{enumerate}
\end{beweis}


Anders als bei den Konstruktoren induktiver Typen, werden wir bei höheren Konstruktoren keine urteilsmäßige Gleichheit für Berechnungen fordern,
sondern nur Gleichheit.

\begin{regeln}
  Es gibt einen Typ $S^1:\mU$ den wir den (höheren induktiven) \begriff{Kreis}\index{Kreis}\index{$S^1$} nennen.
  $S^1$ ist der höhere induktive Typ mit den Konstruktoren:
  \begin{align*}
    \ast:S^1 \\
    l:\ast =_{S^1}\ast
  \end{align*}
  Das heißt für jeden abhängigen Typ $B:S^1\to\mU$ reicht es $b:B(\ast)$ und $b_l:b =_l^B b$ vorzugeben,
  um eine abhängige Funktion $s:\prod_{x:S^1}B(x)$ zu definieren.
  Es gibt also eine Funktion:
  \begin{mathpar}
    \ind{S^1}:\prod_{B:S^1\to\mU}\prod_{b:B(\ast)}\left((b =_l^B b)\to\prod_{x:S^1}B(x)\right)
  \end{mathpar}
  die $\begriff{Kreisinduktion}$.
  Es gelten folgende Berechnungsregeln:
  \begin{align*}
    \ind{S^1}(B,b,b_l)(\ast)&\equiv b \\
    \mathrm{apd}(\ind{S^1}(B,b,b_l),l)\equiv \ind{S^1}(B,b,b_l)(l)&=b_l
  \end{align*}
  Wir werden abhängige Funktionen $s:\prod_{x:S^1}B(x)$ auch durch Fallunterscheidung wie folgt angeben:
  \begin{align*}
    s(\ast)\colonequiv b \\
    s(l):= b_l
  \end{align*}
\end{regeln}

\begin{bemerkung}
  Wie bereits bei den induktiven Typen, werden wir auch hier darauf verzichten, ein allgemeines Schema anzugeben.
  Unter Homotopietypentheorie versteht man eine Typentheorie wie soweit eingeführt, in der jeder sinnvolle höhere induktive Typ existiert.
  Wir werden lediglich Beispiele von sinnvollen höheren induktiven Typen kennenlernen.
\end{bemerkung}

Wir wollen zunächst das Rekursionprinzip für den Kreis herleiten.

\begin{bemerkung}
  Für $A:\mU$, $a:A$ und $a_l:a=_A a$ gibt es stets eine Funktion $\rec{S^1}(A,a,a_l):S^1\to A$ mit
  \begin{align*}
    \rec{S^1}(A,a,a_l)(\ast)\equiv a \\
    \rec{S^1}(A,a,a_l)(l)=a_l
  \end{align*}
\end{bemerkung}
\begin{beweis}
  Wir verwenden Kreisinduktion für den konstanten abhängigen Typ $\_\mapsto A:S^1\to\mU$.
  Es gibt eine Äquivalenz
  \begin{mathpar}
    (a =_l a) \simeq (a =_A a)
  \end{mathpar}
  durch Linkskonkatenation mit $\transpconst_{l,a}^{-1}$.
  Wir verwenden die Inverse, um aus $a_l:a=_A a$ die Gleichheit $\transpconst_{l,a}\kon a_l:a=_l a$ zu produzieren.
  Damit gilt für
  \begin{mathpar}
    \rec{S^1}(A,a,a_l)\colonequiv \ind{S^1}(\_\mapsto A, a, \transpconst_{l,a}\kon a_l)
  \end{mathpar}
  nach \cref{bem:transpconst}:
  \begin{align*}
    \mathrm{ap}(\rec{S^1}(A,a,a_l),l)&\equiv \mathrm{ap}(\ind{S^1}(\_\mapsto A, a, \transpconst_{l,a}\kon a_l),l) \\
                                     &=\transpconst_{l,a}^{-1}\kon\mathrm{apd}(\ind{S^1}(\_\mapsto A, a, \transpconst_{l,a}\kon a_l),l) \\
                                     &=\transpconst_{l,a}^{-1}\kon\transpconst_{l,a}\kon a_l \\
                                     &=a_l
  \end{align*}
  Nach Definition gilt außerdem $\rec{S^1}(A,a,a_l)(\ast)\equiv a$.
\end{beweis}

Bevor wir den Kreis weiter kennenlernen, betrachten wir noch einen weiteren, sehr ähnlichen höheren induktiven Typ.

\begin{regeln}
  Es gibt einen Typ $I:\mU$, das \begriff{Intervall} mit den folgenden Konstruktoren:
  \begin{align*}
    0_I:I \\
    1_I:I \\
    s:0_I =_I 1_I
  \end{align*}
  Daraus ergibt sich das folgende Induktionsprinzip, die \begriff{Intervallinduktion}:
  \begin{mathpar}
    \ind{I}:\prod_{B:I\to\mU}\prod_{b_0:B(0_I)}\prod_{b_1:B(1_I)}b_0 =_s^B b_1 \to\prod_{x:I}B(x) 
  \end{mathpar}
  mit Berechnungsregeln:
  \begin{align*}
    \ind{I}(B,b_0,b_1,b_s)(0_I)\equiv b_0 \\
    \ind{I}(B,b_0,b_1,b_s)(1_I)\equiv b_1 \\
    \mathrm{apd}(\ind{I}(B,b_0,b_1,b_s),s)\equiv\ind{I}(B,b_0,b_1,b_s)(s) = b_s \\
  \end{align*}
\end{regeln}

\begin{bemerkung}
  Das Intervall $I$ ist kontrahierbar.
\end{bemerkung}
\begin{beweis}
  Als Kontraktionszentrum wählen wir $0_I$. Nun wollen wir zeigen:
  \begin{mathpar}
    \prod_{x:I}0_I=x
  \end{mathpar}
  Mit Intervallinduktion reicht es dafür festzustellen, dass $\refl:0_I=0_I$ und $s:0_i=1_I$ gelten und zu zeigen:
  \begin{mathpar}
    \refl =_s s
  \end{mathpar}
  oder anders formuliert: $\transp_{0_I=\_}(s)(\refl)=s$. Das haben wir aber bereits allgemein geklärt in \cref{lem:transp-lpath}.
\end{beweis}

Trotzdem können wir mit dem Intervall etwas neues zeigen.
Davor brauchen wir noch das Rekursionsprinzip.
\begin{lemma}[Intervallrekursion und ihre Eindeutigkeit]
  Sei $A:\mU$.
  \begin{enumerate}
  \item Für $a,a':A$ und $a_s:a=_A a'$ gibt es
    \begin{mathpar}
      \rec{I}(A,a,a',a_s):I\to A
    \end{mathpar}
    mit $\rec{I}(A,a,a',a_s)(0_I)\equiv a$, $\rec{I}(A,a,a',a_s)(1_I)\equiv a'$ und $\rec{I}(A,a,a',a_s)(s) = a_s$.
  \item Für $f:I\to A$ gilt:
    \begin{mathpar}
      f=\rec{I}(A,f(0_I),f(1_I),f(s))
    \end{mathpar}
  \end{enumerate}
\end{lemma}
\begin{beweis}
  \begin{enumerate}
  \item Wie bei der Kreisrekursion.
  \item Noch nicht entschieden, ob das eine Übungsaufgabe ist.
  \end{enumerate}
\end{beweis}

Zunächst erweitern wir die Definition von Homotopien auf abhängige Typen:
\begin{definition}
  Seien $A:\mU$, $B:A\to \mU$ und $f,g:\prod_{x:A}B(x)$. Eine \begriff{abhängige Homotopie}\index{$\sim$} von $f$ nach $g$ ist ein Term von
  \begin{mathpar}
    f\sim g\colonequiv \prod_{x:A}f(x)=g(x)
  \end{mathpar}
  Weiter verwenden wir in diesem Abschnitt die Funktion
  \begin{mathpar}
    \mathrm{hap}\colonequiv (p:f=g)\mapsto (x:A)\mapsto\mathrm{ap}(f\mapsto f(x),p) :f=g\to f\sim g
  \end{mathpar}
\end{definition}

\begin{theorem}[Abhängige Funktionsextensionalität]
  Seien $A:\mU$ und $B:A\to\mU$. Dann gilt für abhängige Funktionen $f,g:\prod_{x:A}B(x)$:
  \begin{enumerate}
  \item Es gibt eine Funktion $\varphi:f\sim g \to f = g$ und es gilt $\mathrm{hap}(\varphi(H))=H$ für jede abhängige Homotopie $H:f\sim g$.
  \item Die Funktion
    \begin{mathpar}
      \mathrm{hap} :f=g\to f\sim g
    \end{mathpar}
    ist eine Äquivalenz.
  \end{enumerate}
\end{theorem}
\begin{beweis}
  \begin{enumerate}
  \item   Zunächst konstruieren wir für $H:\prod_{x:A}f(x)=g(x)$ eine Gleichheit $p_H:f=g$.
  Für $x:A$ können wir die Gleichheit $f(x)=g(x)$ durch eine Abbildung $I\to B(x)$ ersetzen
  und damit $H$ durch die Abbildung
  \begin{mathpar}
    \tilde{H}\colonequiv (x:A)\mapsto \rec{I}(B(x),f(x),g(x),H_x) : \prod_{x:A}I\to B(x)
  \end{mathpar}
  Nun vertauschen wir $A$ und $I$:
  \begin{mathpar}
    \tilde{\tilde{H}}\colonequiv (i:I)\mapsto (x:A)\mapsto \tilde{H}(x)(i) : I\to\prod_{x:A}B(x)
  \end{mathpar}
  Und damit haben wir $p_H\colonequiv \tilde{\tilde{H}}(s) : f=g$.

  Nun können wir durch kommutieren von $\mathrm{ap}$ und $\circ$ sehen, dass gilt:
  \begin{align*}
    \mathrm{hap}(\varphi(H))&\equiv (x:A)\mapsto\mathrm{ap}(f\mapsto f(x),\varphi(H)) \\
                            &\equiv (x:A)\mapsto\mathrm{ap}(f\mapsto f(x),\mathrm{ap}((i:I)\mapsto (y:A)\mapsto \tilde{H}(y)(i),s)) \\
                            &= (x:A)\mapsto \mathrm{ap}((i:I)\mapsto \tilde{H}(x)(i),s) \\
                            &= (x:A)\mapsto H_x
  \end{align*}
\item Nun können wir den Gleichheitssatz verwenden, wenn wir es schaffen zu zeigen, dass
  \begin{mathpar}
    \sum_{g:\prod_{x:A}B(x)}f\sim g
  \end{mathpar}
  kontrahierbar ist. Dazu berechnen wir erstmal mit Gleichheitsinduktion über $p:g=g'$,
  dass für den entsprechenden Transport und eine Homotopie $H:f\sim g$ gilt:
  \begin{mathpar}
    \transp_{g\mapsto f\sim g}(p)(H)=(x:A)\mapsto H_x\kon \mathrm{hap}(p)_x
  \end{mathpar}
  Sei $(f,x\mapsto \refl_{f(x)})$ unser Kontraktionszentrum.
  Dann ist für jedes weitere $(g,H):\sum_{g:\prod_{x:A}B(x)}f\sim g$ durch die Konstruktion am Anfang des Beweises eine Gleichheit $p_H:f=g$ gegeben.
  Um zu zeigen, dass $(f,x\mapsto \refl_{f(x)})=(g,H)$ gilt, müssen wir nach der Charakterisierung in \cref{lem:gleichheit-summe} also nur noch zeigen:
  \begin{mathpar}
    \transp_{g\mapsto f\sim g}(p_H)(x\mapsto\refl_{f(x)})=H
  \end{mathpar}
  Linke und rechte Seite dieser Gleichung sind abhängige Funktionen des Typs $\prod_{x:A}f(x)=g(x)$,
  also können wir die Konstruktion ``$p_H$'' anwenden, um die benötigte Gleichheit aus einer Punktweisen Gleichheit, also aus 
  \begin{mathpar}
    \transp_{g\mapsto f\sim g}(p_H)(x\mapsto\refl_{f(x)})\sim H
  \end{mathpar}
  zu folgern. Diese gilt aber bereits nach der Berechnung des Transports und (a).
\end{enumerate}
\end{beweis}

Nachdem wir nun die vermutlich einfachsten nicht-trivialen höheren induktiven Typen (HIT) kennen gelernt haben,
wollen wir uns zum Abschluss des Abschnitts noch einem etwas komplizierteren HIT widmen,
dem sogenannten Mengenquotient.

\begin{regeln}
  Seien $A:\mU$ und $R:A\to A\to \mU$. Dann ist $A / R:\mU$ der höhere induktive Typ mit den folgenden Konstruktoren:
  \begin{align*}
    [\_]&:A\to A / R \\
    \mathrm{eq /}&:\prod_{x,y:A}R(x,y)\to [x] =_{A / R} [y] \\
    \mathrm{set /}&:\prod_{x,y:A / R}\prod_{p,q : x=y}p=q
  \end{align*}
  Der Typ $A / R$ heißt \begriff{Mengenquotient}.
\end{regeln}

\begin{bemerkung}
  $A / R$ ist stets eine Menge. Und es gibt folgendes Rekursionsprinzip:
  Für jede Menge $B$, Funktion $f:A\to B$ und Nachweis, dass die Relation respektiert wird,
  also einen Term in
  \begin{mathpar}
    r:\prod_{x,y:A}R(x,y)\to f(x)=_B f(y)
  \end{mathpar}
  gibt es eine Funktion
  \begin{mathpar}
    \rec{A / R}(B,f,r) : A / R \to B
  \end{mathpar}
  Analog gibt es ein vereinfachtes Induktionsprinzip.
  Für jede Aussage $P:A / R \to \mU$ (also $P(x)$ Aussage für jedes $x:A / R$) reicht es $P([a])$ für alle $a:A$ zu zeigen, um $\prod_{x:A / R}P(x)$ zu zeigen.
\end{bemerkung}
\begin{beweis}
  Auf die Fälle für die höheren Konstruktoren kann jeweils verzichtet werden, da die entpsrechenden Gleichheiten in Mengen bzw. Aussagen stets existieren.
\end{beweis}

Wir werden nun die Konstruktion von $\Z$ als Quotient der Menge der Paare in $\N\times \N$ mithilfe von Mengenquotienten nachbauen.
Die Paare $(n,k):\N\times\N$ darf man sich als Differenz ``$n-k$'' vorstellen, was auch die folgende Relation erklärt.

\begin{definition}
  Sei für $(n,k),(n',k'):\N\times\N$:
  \begin{mathpar}
    (n,k) \sim_\Z (n',k')\colonequiv n+k'=_\N n'+k
  \end{mathpar}
  Die \begriff{Ganzen Zahlen}\index{$\Z$} sind wie folgt als Mengenquotient gegeben:
  \begin{mathpar}
    \Z\colonequiv \N\times\N / {\sim_\Z}
  \end{mathpar}
\end{definition}

\begin{definition}
  Die Funktion $\mathrm{succ}_\Z:\Z \to \Z$ sei durch Rekursion gegeben durch:
  \begin{mathpar}
    s(n,k)\colonequiv (\sucN(n),k) 
  \end{mathpar}
  und den Nachweis der Wohldefiniertheit:
  Sei $(n,k)\sim_\Z (n',k')$, dann gilt $n+k'=n'+k$, also auch $\sucN(n+k')=\sucN(n'+k)$.
  Letzteres ist nach der Definition der Addition $\sucN(n)+k'=\sucN(n')+k$, also gilt $s(n,k)\sim_\Z s(n',k')$.
\end{definition}

\subsection{n-Typen}
In \cref{def:kontr-aussage-menge} hatten wir bereits kontrahierbare Typen, Aussagen und Mengen definiert.
Die Mengen haben den alternativen Namen $0$-Typen und zu Aussagen, kann man auch $-1$-Typen und zu kontrahierbaren Typen $-2$-Typen sagen.
Wir werden in diesem Abschnitt $n$-Typen definieren, für $n=-2,-1,0,1,\dots$.
Dazu sei zunächst:
\begin{definition}
  Es sei $\N_{-2}$ der induktive Typ mit Konstruktoren $-2:\N_{-2}$ und $\sucHL:\N_{-2}\to\N_{-2}$.
  Für $\sucHL(n)$ schreiben wir $n+1$.
  Die Elemente von $\N_{-2}$ nennen wir auch \begriff{Abschneidungslevel}.
\end{definition}
Damit können wir $n$-Typen für jeden Abschneidungslevel $n$ definieren:
\begin{definition}
  \begin{enumerate}
  \item Für jeden Typ $A$ sei der Typ $\isNType{n}$ wie folgt per Rekursion über $n:\N_{-2}$ definiert:
    \begin{align*}
      \isNType{(-2)}(A)&\colonequiv \isContr(A) \\
      \isNType{(n+1)}(A)&\colonequiv \prod_{x,y:A}\isNType{n}(x=_A y)
    \end{align*}
  \item Der \begriff{Typ der $n$-Typen} ist für $n:\N_{-2}$:
    \begin{mathpar}
      n\mathrm{-Type}\colonequiv \sum_{A:\mU} \isNType{n}(A)
    \end{mathpar}
    Diesen Typ gibt es also für jeden Universenlevel.
  \end{enumerate}
\end{definition}

\begin{lemma}
  Sind Typen $A,B:\mU$ äquivalent und ist $A$ ein $n$-Typ, dann ist auch $B$ ein $n$-Typ.
\end{lemma}
\begin{beweis}
  Univalenz.
\end{beweis}

\begin{lemma}
  \label{lem:pi-n-type}
  Sei $A:\mU$ und $B:A\to\mU$ so, dass $B(x)$ für jedes $x:A$ ein $n$-Typ ist.
  Dann ist $\prod_{x:A}B(x)$ ein $n$-Typ.
\end{lemma}
\begin{beweis}
  Wir beweisen zunächst den Fall $n\equiv -2$. Seien also die $B(x)$ kontrahierbar.
  Dann gibt es eine abhängige Funktion $z:\prod_{x:A}B(x)$, die jedes $x:A$ auf das Kontraktionszentrum von $B(x)$ abbildet.
  Es reicht also zu zeigen, dass $\prod_{x:A}B(x)$ eine Aussage ist.
  Seien dazu $f,g:\prod_{x:A}B(x)$. Wir wollen $f=g$ zeigen.
  Mit abhängiger Funktionsextensionalität reicht es zu zeigen, dass $f\sim g$ gilt.
  Wir wissen aber, dass für jedes $x:A$ bereits $f(x)=g(x)$ gilt, da $B(x)$ eine Aussage ist.

  Wir zeigen nun die eigentliche Aussage per Induktion über den Abschneidungslevel.
  Seien nun also die $B(x)$ $n+1$-Typen.
  Für $f,g:\prod_{x:A}B(x)$ gilt $f=g \simeq f\sim g \equiv \prod_{x:A}f(x)=_{B(x)}g(x)$.
  Letzteres ist ein Gleichheitstyp in einem $n+1$-Typ, also ein $n$-Typ.
  Damit können wir die Induktionshypothese anwenden und sehen, dass auch $f=g$ ein $n$-Typ sein muss und damit dass $\prod_{x:A}B(x)$ ein $n+1$-Typ ist.
\end{beweis}

\begin{lemma}
  \label{lem:isprop-hlevel}
  Sei $A:\mU$. Für jedes $n:\N_{-2}$ gilt $\isProp(\isNType{n}(A))$.
\end{lemma}
\begin{beweis}
  Induktion über den Abschneidungslevel.
  Wir zeigen also zunächst: $\isProp(\isContr(A))$.
  Seien also
  \begin{mathpar}
    (a,H),(a',H'):\isContr(A)\equiv\sum_{x:A}\prod_{y:A}x=y
  \end{mathpar}
  Mit \cref{lem:gleichheit-summe} müssen wir also zeigen:
  \begin{mathpar}
    \sum_{p:a=a'}\transp_{x\mapsto \prod_{y:A}x=y}(p)(H)=H'
  \end{mathpar}
  wobei der Transport die Linkskonkatenation mit $p^{-1}$ ist.
  Wir wählen $p\colonequiv H_{a'}$. Dann ist noch zu zeigen:
  \begin{mathpar}
    \prod_{y:A}H_{a'}^{-1}\kon H_y=H'_y
  \end{mathpar}
  Das lässt sich etwas überraschend auf dem Umweg über die Verallgemeinerung
  \begin{mathpar}
    \prod_{q:x=y}H_{x}^{-1}\kon H_y=q
  \end{mathpar}
  mit Gleichheitsinduktion zeigen. Damit ist also $\isContr(A)$ eine Aussage.

  Jetzt nehmen wir also an, dass $\isNType{n}(A)$ eine Aussage ist und zeigen, dass $\isNType{(n+1)}(A)$ eine Aussage ist.
  Nach Definition gilt
  \begin{mathpar}
    \isNType{(n+1)}(A)\equiv \prod_{x,y:A}\isNType{n}(x=_A y)
  \end{mathpar}
  Für festes $x:A$ ist also mit \cref{lem:pi-n-type} der Typ $\prod_{y:A}\isNType{n}(x=_A y)$ eine Aussage.
  Mit erneutem Anwenden von \cref{lem:pi-n-type}, ist also auch $\prod_{x:A}\prod_{y:A}\isNType{n}(x=_A y)$ eine Aussage.
\end{beweis}


Damit können wir sofort einsehen:

\begin{korollar}
  Seien $A,B:\mU$ und $f:A\to B$.
  Die folgende Definition von $\isEquiv(f)$ ist eine Aussage:
  \begin{mathpar}
    \prod_{y:B}\isContr(f^{-1}(y))
  \end{mathpar}
\end{korollar}

\begin{beweis}
  Zunächst wissen wir durch \cref{lem:isprop-hlevel}, dass $\isContr(f^{-1}(y))$ für jedes $y:B$ eine Aussage ist.
  Mit \cref{lem:pi-n-type} wissen wir außerdem, dass das abhängige Produkt über Aussagen wieder eine Aussage ist.
\end{beweis}

Wir haben in \cref{lem:pi-n-type} bereits gesehen, dass die Gesamtheit der $n$-Typen für festes $n$ unter abhängigen Produkten abgeschlossen ist.
Nun werden wir sehen, dass Ähnliches für den Großteil der Konstruktionen gilt, die wir soweit kennen.

\begin{bemerkung}
  \label{bem:n-type-cumulative}
  \begin{enumerate}
  \item Jeder $n$-Typ ist auch ein $(n+1)$-Typ.
  \item Wenn $A$ ein $n$-Typ ist, dann sind auch alle Gleichheitstypen $x=_A y$ für $x,y:A$ wieder $n$-Typen.
  \end{enumerate}
\end{bemerkung}
\begin{beweis}
  \begin{enumerate}
  \item Sei zunächst $n\equiv -2$, also $A$ kontrahierbar mit Zeugen $(z,H):\isContr(A)$.
    Für $x,y:A$ wählen wir $H^{-1}_x\kon H_y: x=_A y$ als Kontraktionszentrum.
    Per Gleichheitsinduktion gibt es für beliebiges $p:x=y$ eine Gleichheit $H_x^{-1}\kon H_y=p$.

    Für den Induktionsschritt sei nun $A$ ein $(n+1)$-Typ.
    Damit sind alle $x=_A y$ $n$-Typen. Nach Induktionshypothese ist $x=y$ also auch ein $(n+1)$-Typ und damit $A$ ein $(n+2)$-Typ.
  \item Für $n\equiv -2$ haben wir das bereits in (a) nachgerechnet.
    Nach Definition ist für einen $n+1$-Typ $A$ jeder Gleichheitstyp ein $n$-Typ, also nach (a) auch ein $n+1$-Typ.
  \end{enumerate}
\end{beweis}

Wenn man bedenkt, dass es für jeden Typ $A$ eine Äquivalenz $A\simeq \sum_{x:A}\eins$ gibt, wird klar, dass für abhängige Summen
kein direktes Analogon zu \cref{lem:pi-n-type} gelten kann. Weiter wäre das seltsam, weil der Spezialfall von Produkten symmetrisch ist.
Es liegt also Nahe, für abhängige Summen auch Bedingungen an die Basis zu stellen, um den Abschneidungslevel zu erhalten:

\begin{lemma}
  \label{lem:sum-n-type}
  Seien $A:\mU$ und $B:A\to\mU$. Wenn $A$ ein $n$-Typ und $B(x)$ für jedes $x:A$ ein $n$-Typ ist, dann ist auch die abhängige Summe $\sum_{x:A}B(x)$ ein $n$-Typ.
\end{lemma}
\begin{beweis}
  Sei $n\equiv -2$, also $A$ kontrahierbar und für jedes $x:A$ $B(x)$ kontrahierbar.
  Wir wählen $(z,b):\sum_{x:A}B(x)$ als Kontraktionszentrum, für ein Kontraktionszentrum $z:A$ von $A$ und $b:B(z)$ von $B(z)$.
  Seien $z':A$ und $b':B(z')$. Es gilt:
  \begin{mathpar}
    (z,b)=(z',b') \simeq \sum_{p:z=z'}\transp_B(p)(b)=b'
  \end{mathpar}
  Die beiden Gleichheiten auf der rechten Seite gibt es jeweils wegen Kontrahierbarkeit.

  Seien nun $A$ und jedes $B(x)$ ein $(n+1)$-Typ. Dann ist ohne Einschränkung zu zeigen, dass für $x,y:A$ und $b:B(x)$, $b':B(y)$ der Typ
  \begin{mathpar}
    (x,b)=(y,b') \simeq \sum_{p:x=y}\transp_B(p)(b)=b'
  \end{mathpar}
  ein $n$-Typ ist. Die rechte Seite ist aber eine abhängige Summe von $n$-Typen, also nach Induktionshypothese ein $n$-Typ.
\end{beweis}

\begin{bemerkung}
  Sei $n\geq 0$. Koprodukte von $n$-Typen sind $n$-Typen.
\end{bemerkung}
\begin{beweis}
  Seien $A,B:\mU$ und $(n+1)\geq 0$ ein Abschneidungslevel.
  Wir zeigen, dass $A\amalg B$ ein $(n+1)$-Typ ist, indem wir zeigen, dass alle Gleichheitstypen von $A\amalg B$ $n$-Typen sind.
  Nach Übungsaufgabe 3 von Blatt 7, ist der Gleichheitsyp des Koprodukts $A\amalg B$ faserweise äquivalent zu:
  \begin{align*}
    \Eq{\amalg}(\iota_1(a),\iota_1(a'))&\colonequiv (a=_A a') \\
    \Eq{\amalg}(\iota_1(a),\iota_2(b))&\colonequiv \leer \\
    \Eq{\amalg}(\iota_2(b),\iota_1(a))&\colonequiv \leer \\
    \Eq{\amalg}(\iota_2(b),\iota_2(b'))&\colonequiv (b=_B b')
  \end{align*}
  Der Typ $\leer$ ist eine Aussage. Da $n\geq -1$ ist, ist also $\leer$ mit \cref{bem:n-type-cumulative} auch ein $n$-Typ.
  Die Typen $a=a'$ und $b=b'$ sind auch jeweils $n$-Typen, also sind alle Gleichheitstypen von $A\amalg B$ $n$-Typen.
\end{beweis}

\begin{bemerkung}
  \begin{enumerate}
  \item Seien $A,B:\mU$ und $f:A\to B$. Die Fasern von $\mathrm{ap}(f,\_):x=y\to f(x)=f(y)$ sind genau dann $n$-Typen, wenn jede Faser von $f$ ein $(n+1)$-Typ ist.
  \item Untertypen von $n$-Typen sind $n$-Typen.
  \end{enumerate}
\end{bemerkung}
\begin{beweis}
  \begin{enumerate}
  \item Die Aussage folgt, wenn die Gleichheitstypen jeder Faser von $f$ äquivalent zu Fasern von $\mathrm{ap}(f,\_)$ sind und umgekehrt.
    Seien also $y:B$ und $(x,p),(x',p'):f^{-1}(y)$, dann gilt:
    \begin{align*}
      (x,p)=(x',p') &\simeq \sum_{q:x=x'}\transp_{f(\_)=y}(q)(p)=p' \\
                    &\simeq \sum_{q:x=x'}f(q)^{-1}\kon p=p' \\
                    &\simeq \sum_{q:x=x'}f(q)=p'^{-1}\kon p \\
                    &\simeq \mathrm{ap}(f,\_)^{-1}(p'^{-1}\kon p)
    \end{align*}
    Und für $p:f(x)=f(y)$ gilt:
    \begin{align*}
      \mathrm{ap}(f,\_)^{-1}(p) &\sum_{q:x=y}f(q)=p \\
      &\simeq \sum_{q:y=x}f(q)^{-1}\kon p=\refl_{f(x)}\\
                                &\simeq ((y,p)=_{f^{-1}(f(x))}(x,\refl_{f(x)}))
    \end{align*}
  \item Das folgt aus (a) für $n\equiv -1$ und Übungsaufgabe 4 von Blatt 9.
  \end{enumerate}
\end{beweis}

Es ist nicht der Fall, dass das Universum der $n$-Typen, also der Typ
\begin{mathpar}
  n\hbox{-}\mathrm{Type}\equiv\sum_{A:\mU}\isNType{n}(A)
\end{mathpar}
wieder ein $n$-Typ ist. Ein Gegenbeispiel ist durch $(\zwei=\zwei)\simeq \zwei$ gegeben: $\zwei$ ist ein $0$-Typ, aber es gibt zwei verschiedene Gleichheiten zwischen $\zwei$ und $\zwei$ im Typ $\nType{0}$.
Letzterer könnte also bestenfalls noch ein $1$-Typ sein. Das ist tatsächlich so:

\begin{bemerkung}
  Der Typ der $n$-Typen ist ein $(n+1)$-Typ.
\end{bemerkung}
\begin{beweis}
  Für $n\equiv -2$, sind alle Typen äquivalent zu $\eins$ und $(\eins=\eins) \simeq \eins$ ist ein (-2)-Typ, also auch ein (-1)-Typ.
  
  Seien nun $A,B:\mU$ zwei (n+1)-Typen. Wir wollen zeigen, dass im Typ der (n+1)-Typen also für Paare $(A,X),(B,Y):\nType{(n+1)}$ gilt, dass $(A,X)=(B,Y)$ ein $n$-Typ ist.
  Da $X,Y$ nur Elemente von Aussagen sind gilt:
  \begin{mathpar}
    \left((A,X)=_{\nType{(n+1)}}(B,Y) \right)\simeq \left(A=_\mU B\right) \simeq (A\simeq B)
  \end{mathpar}
  Letzteres ist ein Untertyp von $A\to B$, was nach \cref{lem:pi-n-type} ein $n$-Typ ist.
\end{beweis}

\subsection{Überlagerungen}

Bevor wir uns dem eigentlichen Thema zuwenden, brauchen wir noch eine Variante der ganzen Zahlen mit einem Rekursionsprinzip,
das uns auch Abbildungen in nicht notwedigerweise 0-abgeschnittene Typen erlaubt.

\begin{regeln}
  Zunächst sei $\N_1:\mU$\index{$\N_1$} der induktive Typ mit Konstruktoren $1_{\N_1}:\N_1$ und $\mathrm{succ}_{\N_1}:\N_1\to\N_1$.
  Nun sei $\Z':\mU$ der induktive Typ mit Konstruktoren:
  \begin{align*}
    0_{\Z'}&:\Z' \\
    \mathrm{pos}&:\N_1\to\Z' \\
    \mathrm{neg}&:\N_1\to\Z'
  \end{align*}
  Wir nennen den Typ $\Z'$ die \begriff{(induktiven) ganzen Zahlen}\index{$\Z'$}\index{$\Z$} und werden auch später auf den Strich verzichten und einfach $\Z$ schreiben.
  Als Induktionsprinzip ergibt sich also, dass wir Konstruktionen für die positiven Zahlen, die negativen Zahlen und die 0 ausführen müssen.
\end{regeln}

\begin{bemerkung}
  Die Typen $\N_1$ und $\Z'$ sind Mengen.
\end{bemerkung}
\begin{beweis}
  Nach \cref{thm:gleichheit-nat} ist der Typ $\N$ eine Menge und dieser ist äquivalent zu $\N_1$.
  Für $\Z'$ führen wir einen Beweis mit der üblichen Methode. Sei dazu $\mathrm{Eq}_{\Z'}:\Z'\to\Z'\to\mU$ gegeben durch:
  \begin{align*}
    \mathrm{Eq}_{\Z'}(0_{\Z'},0_{\Z'})&\colonequiv \eins \\
    \mathrm{Eq}_{\Z'}(\mathrm{pos}(n),\mathrm{pos}(k))&\colonequiv n=_{\N_1}k \\
    \mathrm{Eq}_{\Z'}(\mathrm{neg}(n),\mathrm{neg}(k))&\colonequiv n=_{\N_1}k \\
    \text{übrige Fälle }&\colonequiv \leer
  \end{align*}
  Den Reflexivitätsterm $r_{\Z'}:\prod_{x:\Z'}\mathrm{Eq}_{\Z'}(x,x)$ können wir definieren als $\ast$, im Fall $x\equiv 0$ und als $\refl_{n}$ in den Fällen $x\equiv \mathrm{pos}(n)$ und $x\equiv \mathrm{neg}(n)$.
  Nun ist etwa für $x\equiv \mathrm{pos}(n)$ zu zeigen, dass
  \begin{mathpar}
    \sum_{x:\Z'}\mathrm{Eq}_{\Z'}(\mathrm{pos}(n),x)
  \end{mathpar}
  kontrahierbar ist. Per Induktion über $x$ ist das nur noch für $x\equiv \mathrm{pos}(k)$ zu zeigen, da in allen anderen Fällen nur etwas für alle Elemente des leeren Typs zu zeigen ist.
  Im Fall $x\equiv \mathrm{pos}(k)$ müssen wir allerdings nur zeigen, dass ein Element $(k,p):\sum_{k:\N_1}n=k$ gleich $(n,\refl)$ ist - das können wir mit \cref{lem:pfade-kontrahierbar} zeigen.
\end{beweis}

\begin{bemerkung}
  Es gilt $\Z\simeq \Z'$. Wir schreiben daher ab jetzt $\Z$ für beide.
\end{bemerkung}
\begin{beweis}
  Übungsaufgabe.
\end{beweis}

Nun können wir uns den Überlagerungen zuwenden. Speziell werden wir mit der universellen Überlagerung des Kreises beginnen.
In der Topologie wird diese als Kopie der reellen Gerade $\R$ konstruiert, die als Helix über dem topologischen Kreis $\mathbb{S}^1=\{(x,y)\in\R^2\vert x^2+y^2=1\}$ liegt.
Als konkrete Projektion von $\R$ auf $\mathbb{S}^1$ kann etwa
\begin{mathpar}
  (t:\R) \mapsto (\cos(2\pi t),\sin(2\pi t))
\end{mathpar}
gewählt werden. Unser folgender abstrakter Nachbau dieser Situation handelt zwar nur von den Homotopietypen der beteiligten topologischen Räume, ist aber trotzdem überraschend ähnlich.
So werden etwa die Fasern der abstrakten Projektion ebenfalls $\Z$ sein.
Tatsächlich werden wir sogar genau damit beginnen.

Unser Ziel wird zunächst sein, zu beweisen, dass der Gleichheitstyp $\ast=_{S^1}\ast$ äquivalent zu $\Z$ ist.
Dazu geben wir diesen spezielleren Gleichheitstypen noch ihren üblichen Namen.

\begin{definition}
  \begin{enumerate}
  \item Ein \begriff{punktierter Typ} ist ein Paar $(A,a):\sum_{A:\mU}A$. Wir werden oft von punktierten Typen $A:\mU$ sprechen und implizit den Punkt mit $\ast:A$ bezeichnen.
  \item Der \begriff{Schleifenraum}\index{$\Omega$} eines punktierten Typs $(A,\ast)$ ist der Typ $\Omega(A,\ast)\colonequiv (\ast=_A\ast)$.
  \end{enumerate}
\end{definition}

\begin{definition}
  Die \begriff{universelle Überlagerung} von $S^1$ ist der abhängige Typ $\tilde{S^1}:S^1\to\mU$ gegeben durch
  \begin{mathpar}
    \tilde{S^1}\colonequiv \rec{S^1}(\mU, \Z, \ua({\mathrm{succ}}_\Z))
  \end{mathpar}
  Es gilt also $\tilde{S^1}(\ast)=\Z$ und $\mathrm{ap}(\tilde{S^1},l)=\ua(\mathrm{succ}_{\Z})$.
\end{definition}

Die letztere Gleichheit lässt sich etwas greifbarer machen und entspricht im topologischen Fall der Monodromieaktion eines Erzeugers der Fundamentalgruppe.


\begin{bemerkung}
  Es gilt $\transp_{\tilde{S^1}}(l)=_{\Z\to\Z}\mathrm{succ}_\Z$.
\end{bemerkung}
\begin{beweis}
  Allgemein gilt für einen abhängigen Typ $B:A\to\mU$:
  \begin{mathpar}
    \prod_{x,y:A}\prod_{p:x=y}\ua(\transp_B(p))=\mathrm{ap}(B,p)
  \end{mathpar}
  was sich per Induktion über $p$ beweisen lässt, da $\ua(\id_{B(x)})=\refl_{B(x)}$ gilt.
  Damit gilt also
  \begin{mathpar}
    \ua(\transp_{\tilde{S^1}}(l))=\mathrm{ap}(\tilde{S^1},l)=\ua(\mathrm{succ}_{\Z})
  \end{mathpar}
  womit die Behauptung folgt, weil $\ua$ eine Äquivalenz ist.
\end{beweis}

Das bedeutet, dass wir den Transport in $\tilde{S^1}$ benutzen können, um Gleichheiten der Form $\ast=_{S^1}\ast$, also Elemente des Schleifenraums $\Omega(S^1,\ast)$, mit $l$ zu vergleichen.
Da $l$ einmal den Kreis durchläuft, kann man mit der folgenden Definition messen, wie oft eine Gleichheit in $\Omega(S^1,\ast)$ den Kreis $S^1$ durchläuft.

\begin{definition}
  Die \begriff{Windungszahl} einer Gleichheit in $\Omega(S^1,\ast)$ ist der Wert unter der Abbildung
  \begin{align*}
    w&:\Omega(S^1,\ast)\to \Z \\
    w(p)&\colonequiv \transp_{\tilde{S^1}}(p)(0)
  \end{align*}
\end{definition}

Die Windungszahl wird sich später als Äquivalenz herausstellen und hat die Eigenschaften eines Gruppenhomomorphismus.
Wir zeigen das zunächst nur für Addition mit 1.

\begin{bemerkung}
  \label{bem:hom-windungszahl}
  Für alle $p:\Omega(S^1,\ast)$ gilt $w(p\kon l)=\mathrm{succ}_{\Z}(w(p))$.
\end{bemerkung}
\begin{beweis}
  Das ist durch die Verträglichkeit von Konkatenation und Komposition von Transporten gegeben:
  \begin{align*}
    w(p\kon l)&=\transp_{\tilde{S^1}}(p\kon l)(0) \\
              &=(\transp_{\tilde{S^1}}(l)\circ\transp_{\tilde{S^1}}(p))(0) \\
              &=\mathrm{succ}_\Z(\transp_{\tilde{S^1}}(p)(0)) \\
    &=\mathrm{succ}_\Z(w(p)) 
  \end{align*}
\end{beweis}

Wenn die Windungszahl eine Äquivalenz ist, bedeutet das, dass jedes $p:\Omega(S^1,\ast)$ von der Form $l^k$ für $k:\Z$ ist.
Also sollte die Inverse von $w$ durch $k$-fache Konkatenation von $l:\Omega(S^1,\ast)$ gegeben sein.

\begin{definition}
  Die \begriff{k-fache Konkatenation}\index{$\_^k$} $\_^k:\Z\to\Omega(S^1,\ast)$ ist $\Z'$- und $\N_1$-rekursiv gegeben durch
  \begin{align*}
    l^0&\colonequiv \refl_\ast \\
    l^{\mathrm{pos}(1)}&\colonequiv l \\
    l^{\mathrm{pos}(n+1)}&\colonequiv l^{\mathrm{pos}(n)}\kon l \\
    l^{\mathrm{neg}(1)}&\colonequiv l^{-1} \\
    l^{\mathrm{neg}(n+1)}&\colonequiv l^{\mathrm{neg}(n)}\kon l^{-1}
  \end{align*}
\end{definition}

Anstatt direkt zu zeigen, dass $\_^k$ und $w$ zueinander invers sind, werden wir eine faserweise Äquivalenz der Form
\begin{mathpar}
  \prod_{x:S^1}\ast=_{\tilde{S^1}}x\to \tilde{S^1}(x)
\end{mathpar}
konstruieren.

\begin{bemerkung}
  Es gibt eine faserweise Abbildung 
  \begin{mathpar}
    W:\prod_{x:S^1}\ast=_{\tilde{S^1}}x\to \tilde{S^1}(x)
  \end{mathpar}
  mit:
  \begin{align*}
    W(\ast)\colonequiv w : \ast=\ast\to\Z 
  \end{align*}
\end{bemerkung}
\begin{beweis}
  Um einzusehen, dass $W$ durch $S^1$-Induktion definiert werden kann, müssen wir berechnen, wie die Abbildung $w$ entlang von $l:\ast=\ast$ transportiert wird.
  Dazu überlegen wir zunächst, was der Transport in einer abstrakteren Situation wäre, nämlich in einem abhängigen Typ der Form:
  \begin{mathpar}
    (x:A) \mapsto B(x)\to C(x)
  \end{mathpar}
  für zwei abhängige Typen $B:A\to\mU$ und $C:A\to\mU$. Die naheliegende Vermutung ist, dass wir mit den Transporten in $B$ und $C$ prä- und postkomponieren müssen.
  Es kann mit Induktion über $p$ geklärt werden, dass gilt:
  \begin{mathpar}
    \transp_{(x:A) \mapsto B(x)\to C(x)}(p)(f)=\transp_C(p) \circ f \circ \transp_B(p^{-1})
  \end{mathpar}
  Den Transport in $x\mapsto \ast=x$ kennen wir, das ist Rechtskonkatenation. Damit die induktive Definition von $W$ wie behauptet funktioniert,
  müssen wir also verifizieren, dass gilt:
  \begin{mathpar}
    \transp_{\tilde{S^¹}}(l) \circ w \circ \transp_{\ast=\_}(l^{-1}) = w
  \end{mathpar}
  Das lässt sich wie folgt punktweise für $p:\ast=\ast$ berechnen:
  \begin{align*}
    \transp_{\tilde{S^¹}}(l) \circ w \circ \transp_{\ast=\_}(l^{-1})(p) &= \transp_{\tilde{S^¹}}(l) \circ w(p\kon l^{-1}) \\
                                                                        &= \transp_{\tilde{S^¹}}(l) \circ \transp_{\tilde{S^1}}(p\kon l^{-1})(0) \\
                                                                        &= \transp_{\tilde{S^¹}}(l) \circ \transp_{\tilde{S^1}}(l^{-1})\circ \transp_{\tilde{S^1}}(p)(0) \\
                                                                        &=\transp_{\tilde{S^1}}(p)(0) \\
                                                                        &=w(p)
  \end{align*}
\end{beweis}




\subsection{Homotopiegruppen}
